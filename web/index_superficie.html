<!DOCTYPE html>
<html>
<head>
  <title>TP Open Data Final</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="" />
  <meta charset="utf-8" />
  <link rel="stylesheet" href="css/leaflet.css" />
  <script src="js/chart/Chart.js"></script>
  <!--[if lte IE 8]><link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.ie.css" /><![endif]-->
  <script src="js/jquery-1.11.1.min.js"></script>
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/bootstrap-theme.min.css" />
  <link rel="stylesheet" href="css/introjs.min.css" />
  <script src="js/bootstrap.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="js/intro.min.js"></script>
  
  <style>

    #map {
      width: 610px;
      height: 500px;
    }

    .leaflet-legend, .leaflet-label {
      background: white;
      background: rgba(255,255,255,0.8);
      box-shadow: 0 0 15px rgba(0,0,0,0.2);      
      border-radius: 5px;   
      font: 14px/16px Arial, Helvetica, sans-serif;       
    }

    .leaflet-legend {
      text-align: left;
      line-height: 18px;
      color: #555;
      z-index: 6;
      width: 110px;         
      padding: 6px 8px;
    }

    .leaflet-legend h4 {
      margin: 0 0 5px 5;
      color: #777;
      text-align: center;
    }

    .leaflet-legend i {
      width: 18px;
      height: 18px;
      float: left;
      margin-right: 8px;
      opacity: 0.7;
    }

    .leaflet-label {
      display: block;
      padding: 6px;
      position: absolute;
      -webkit-user-select: none;
         -moz-user-select: none;
          -ms-user-select: none;
              user-select: none;
      white-space: nowrap;
      z-index: 8;
      margin-top: 35px;
    }

    .legend {
    	line-height: 18px;
    	color: #555;
    }

    .legend i {
    	width: 18px;
    	height: 18px;
    	float: left;
    	margin-right: 10px;
    	opacity: 0.7;
    }

  </style>
</head>
<body>
    <nav class="navbar navbar-default navbar-static-top" role="navigation" id="id1">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Distribucion de Recusos:</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse" >
          <ul class="nav navbar-nav">
            <li class="active"><a href="index_matriculados.html">Visualizacion</a></li>
            <li><a href="datos.html">Datos</a></li>
            <li><a href="about.html">Acerca de</a></li>
            <li><a href="https://github.com/emperador/tpopendata">Source:github</a></li>
            <li> <button id="guia" onClick="introguide.start()" style=" margin-top: 10px">Guia del Sitio</button></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><img id="cc-by" src="images/cc-by-sa-logo.png" alt="Open Data" style=" margin-top: 10px"></li>
            <li><img id="opendata" src="images/od-logo.png" alt="Open Data" style=" margin-top: 10px"></li>
           
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    <div class="row">
    <div class="col-md-5" style=" margin-left: 20px">
    
    <div class="row" style=" margin-top: 0px">
        <label style=" font-size: 20px; margin-left: 10px">Numeros:</label>
        <select onClick="window.location.href=this.value" id="numeros" class="btn btn-info" style="margin-left: 0px">
            <option value="index_superficie.html">SUPERFICIE</option>
            <option value="index_matriculados.html">matriculados</option>
            <option value="index_muebles.html">muebles</option>
            <option value="index_docentes.html">docentes</option>
        </select>
        <label style=" font-size: 20px">Porcentajes:</label>
        <select onClick="window.location.href=this.value" id="porcentajes" class="btn btn-success" style="margin-left: 0px">
            <option value="index_matriculados_porcentaje.html">matriculados</option>
            <option value="index_muebles_porcentaje.html">muebles</option>
            <option value="index_superficie_porcentaje.html">superficie</option>
            <option value="index_doc_porcentaje.html">docentes</option>
        </select>
        
    </div>
    <div class="row">
        <h3>Superficie por departamento</h3>
  <div id="map"></div>
  <script src="js/leaflet.js"></script> 
  <script src="js/leaflet.label.js"></script>      
  <script src="js/L.Choropleth.js"></script>    
  <script src="js/py-dptos.js"></script> 
  <script>
    var map = L.map('map',{maxZoom: 8,minZoom: 6}).setView([-23.5, -58.5], 6);

    
    
    var mapa_option={
      name: 'Paraguay, Superficie por Departamento',
      unit: 'superficie en miles de m<sup>2</sup>',
      key: 'superficie_por_dpto',
      classBreaks: [0, 750, 1500, 2250, 3000, 3750, 4500, 6500],
      colors: ['#ffdccc','#ffb899','#ff9566','#ff7133','#cc3e00','#992f00', '#661f00', '#331000'],
      normalStyle: {
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7
      },
      highlightStyle: {
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
      },
      onEachFeature: function(feature, layer) {
        layer.bindLabel(this.featureLabel(feature)).addTo(map);
      }
    };

    var varChoropleth=L.choropleth(statesData, mapa_option ).on({
      click: function(e) {
        //map.fitBounds(e.layer.getBounds());
        //alert(e.layer.feature.id);
//        alert('hola soy  jorgito= ');
        var trunc_matriculados=e.layer.feature.properties.matriculados_por_dpto/1307150*100;
        trunc_matriculados=trunc_matriculados.toFixed(2);
        var trunc_muebles=e.layer.feature.properties.monto_muebles_por_dpto/267605*100;
        trunc_muebles=trunc_muebles.toFixed(2);
        var trunc_superficie=e.layer.feature.properties.superficie_por_dpto/40583*100;
        trunc_superficie=trunc_superficie.toFixed(2);
        var trunc_docentes=e.layer.feature.properties.monto_docentes_por_dpto/59497*100;
        trunc_docentes=trunc_docentes.toFixed(2);

        $('#estado').text("Porcentaje sobre el total: "+e.layer.feature.properties.name);
	var barChartData = {
		labels : ["Matriculados","Muebles","Superficie","Docentes"],
		datasets : [
			{
				fillColor : "rgba(220,220,220,0.5)",
				strokeColor : "rgba(220,220,220,0.8)",
				highlightFill: "rgba(220,220,220,0.75)",
				highlightStroke: "rgba(220,220,220,1)",
				data : [trunc_matriculados,
                                    trunc_muebles,
                                    trunc_superficie,
                                    trunc_docentes]
			}
		]
	};
                
                var oldcanv = document.getElementById('canvas');
                var holder=document.getElementById('holder');
                holder.removeChild(oldcanv);

                var canv = document.createElement('canvas');
                canv.id = 'canvas';
                canv.height="500";
                canv.width="600";
                holder.appendChild(canv);
                
                
        	var ctx = document.getElementById("canvas").getContext("2d");
		window.myBar = new Chart(ctx).Bar(barChartData, {
			responsive : false
		});
                
                myBar.datasets[0].bars[0].fillColor = "green"; //bar 1
                myBar.datasets[0].bars[0].highlightFill="#312f2f";
                myBar.datasets[0].bars[1].fillColor = "orange"; //bar 2
                myBar.datasets[0].bars[1].highlightFill="#312f2f";
                myBar.datasets[0].bars[2].fillColor = "red"; //bar 3
                myBar.datasets[0].bars[2].highlightFill="#312f2f";
                myBar.datasets[0].bars[3].fillColor = "blue";
                myBar.datasets[0].bars[3].highlightFill="#312f2f";
                myBar.update();    
                
      }
    });
    
    varChoropleth.addTo(map);

    var legend = L.control({position: 'bottomleft'});
    legend.onAdd = function (map) {
    	var div = L.DomUtil.create('div', 'info legend'),
    	    grades = [0, 750, 1500, 2250, 3000, 3750, 4500, 6250],
    	    labels = ['0',  '750', '1.500', '2.250', '3.000', '3.750', '4.500', '6.250'];
    	// loop through our density intervals and generate a label with a colored square for each interval
    	for (var i = 0; i < grades.length; i++) {
    	    div.innerHTML +=
    	        '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' + 'en miles de m<sup>2</sup>: ' +
    	        grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    	}
    	return div;
    };
    legend.addTo(map);
   
    function getColor(d) {
    	return d > 6250 ? '#331000' : 
           d > 4500  ? '#661f00' :
           d > 3750  ? '#992f00' :
           d > 3000  ? '#cc3e00' :
           d > 2250   ? '#ff7133' :
           d > 1500   ? '#ff9566' :
           d > 750   ? '#ffb899' :
                      '#ffdccc';
    }
//colors: ['#ffdccc','#ffb899','#ff9566','#ff7133','#cc3e00','#992f00', '#661f00', '#331000'],

  </script>
      </div>
 </div>
 <div id="barras" class="col-md-5" style=" margin-left: 40px; ">
     <div class="row">
          
<label id="estado" style=" margin-left: 40px; margin-right: auto; margin-top: 0px;height: 100%; width: 100%;text-align: center; font-size: 25px;">Porcentaje sobre el total: Asunci√≥n</label>
<p style=" margin-left: 40px; margin-right: auto; font-size: 9px">Los datos del grafico
    representan los porcentajes correspondientes a un departamento sobre el total de: matriculados(cantidad de alumnos matriculados)
    , muebles(monto invertido en muebles), superficie(superficie en metros cuadrados disponible para inmueble)
    ,docentes(monto invertido en funcionarios docentes)</p>
      </div>
 <div style="width: 50%" id="holder">
			<canvas id="canvas" height="500" width="600"></canvas>
			
    </div>
  
  
  <script>
          
        
        
      
	window.onload = function(){
            var trunc_matriculadosini=statesData.features[3].properties.matriculados_por_dpto/1307150*100;
            trunc_matriculadosini=trunc_matriculadosini.toFixed(2);
            var trunc_mueblesini=statesData.features[3].properties.monto_muebles_por_dpto/267605*100;
            trunc_mueblesini=trunc_mueblesini.toFixed(2);
            var trunc_superficieini=statesData.features[3].properties.superficie_por_dpto/40583*100;
            trunc_superficieini=trunc_superficieini.toFixed(2);
            var trunc_docentesini=statesData.features[3].properties.monto_docentes_por_dpto/59497*100;
            trunc_docentesini=trunc_docentesini.toFixed(2);
            
            var barChartData = {
		labels : ["Matriculados","Muebles","Superficie","Docentes"],
		datasets : [
			{
				fillColor : "rgba(220,220,220,0.5)",
				strokeColor : "rgba(220,220,220,0.8)",
				highlightFill: "rgba(220,220,220,0.75)",
				highlightStroke: "rgba(220,220,220,1)",
				data : [trunc_matriculadosini,
                                    trunc_mueblesini,
                                    trunc_superficieini,
                                    trunc_docentesini]
			}
		]
	};
                       
                
        	var ctx = document.getElementById("canvas").getContext("2d");
		window.myBar = new Chart(ctx).Bar(barChartData, {
			responsive : false
		});
                
                myBar.datasets[0].bars[0].fillColor = "green"; //bar 1
                myBar.datasets[0].bars[0].highlightFill="#312f2f";
                myBar.datasets[0].bars[1].fillColor = "orange"; //bar 2
                myBar.datasets[0].bars[1].highlightFill="#312f2f";
                myBar.datasets[0].bars[2].fillColor = "red"; //bar 3
                myBar.datasets[0].bars[2].highlightFill="#312f2f";
                myBar.datasets[0].bars[3].fillColor = "blue";
                myBar.datasets[0].bars[3].highlightFill="#312f2f";
                myBar.update();             
	};
        
        
        
     
	</script>
  </div>
</div>
    <script type="text/javascript" src="js/myintro.js"></script>
</body>
</html>
