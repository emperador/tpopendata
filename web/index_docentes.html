<!DOCTYPE html>
<html>
<head>
  <title>TP Open Data Final</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="css/leaflet.css" />
  
  <script src="js/chart/Chart.js"></script>
  <script src="js/jquery-1.11.1.min.js"></script>
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/bootstrap-theme.min.css" />
  <script src="js/bootstrap.min.js" type="text/javascript"></script>
  
  <!--[if lte IE 8]><link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.ie.css" /><![endif]-->
  <style>

    #map {
      width: 610px;
      height: 500px;
    }

    .leaflet-legend, .leaflet-label {
      background: white;
      background: rgba(255,255,255,0.8);
      box-shadow: 0 0 15px rgba(0,0,0,0.2);      
      border-radius: 5px;   
      font: 14px/16px Arial, Helvetica, sans-serif;       
    }

    .leaflet-legend {
      text-align: left;
      line-height: 18px;
      color: #555;
      z-index: 6;
      width: 110px;         
      padding: 6px 8px;
    }

    .leaflet-legend h4 {
      margin: 0 0 5px 5;
      color: #777;
      text-align: center;
    }

    .leaflet-legend i {
      width: 18px;
      height: 18px;
      float: left;
      margin-right: 8px;
      opacity: 0.7;
    }

    .leaflet-label {
      display: block;
      padding: 6px;
      position: absolute;
      -webkit-user-select: none;
         -moz-user-select: none;
          -ms-user-select: none;
              user-select: none;
      white-space: nowrap;
      z-index: 8;
      margin-top: 35px;
    }

    .legend {
    	line-height: 18px;
    	color: #555;
    }

    .legend i {
    	width: 18px;
    	height: 18px;
    	float: left;
    	margin-right: 10px;
    	opacity: 0.7;
    }

  </style>
</head>
<body>
 <div class="row">
  <div class="col-md-5" style=" margin-left: 20px">
    <div class="row">
    <button onclick="location.href='index_matriculados.html'" class="btn btn-info" style=" width: 275px">números</button>    <button onclick="location.href='index_matriculados_porcentaje.html'" class="btn btn-success" style=" width: 275px">porcentajes</button>
    </div>
    <div class="row">
    <button onclick="location.href='index_matriculados.html'" class="btn btn-info" style=" width: 138px">matriculados</button><button onclick="location.href='index_muebles.html'" class="btn btn-info" style=" width: 137px">muebles</button><button onclick="location.href='index_superficie.html'" class="btn btn-info" style=" width: 138px">superficie</button ><button onclick="location.href='index_docentes.html'" class="btn btn-info" style=" width: 137px">docentes</button>
    </div>
    <div class="row">
    <div id="map"></div>
    <script src="js/leaflet.js"></script> 
    <script src="js/leaflet.label.js"></script>      
    <script src="js/L.Choropleth.js"></script>    
    <script src="js/py-dptos.js"></script> 
    
    <script>
        
      var map = L.map('map',{maxZoom: 8,minZoom: 6}).setView([-23.5, -58.5], 6);

      var mapa_option={
        name: 'Paraguay, Monto invertido en docentes por Departamento',
        unit: 'monto en millones de Gs ',
        key: 'monto_docentes_por_dpto',
        classBreaks: [1, 1500, 3000, 4500, 6000, 7500, 9000, 12500],
        colors: ['#9999e1','#6a6abf','#4646a0','#2b2b88','#181866','#0d0d4d', '#07073f', '#020227'],
        normalStyle: {
          weight: 2,
          opacity: 1,
          color: 'white',
          dashArray: '3',
          fillOpacity: 0.7
        },
        highlightStyle: {
          weight: 5,
          color: '#666',
          dashArray: '',
          fillOpacity: 0.7
        },
        onEachFeature: function(feature, layer) {
          layer.bindLabel(this.featureLabel(feature)).addTo(map);
        }
      };

      var varChoropleth=L.choropleth(statesData, mapa_option ).on({
        click: function(e) {
          //map.fitBounds(e.layer.getBounds());
          //alert(e.layer.feature.id);
  //        alert('hola soy  jorgito= ');
  
            $('#estado').text("Porcentaje sobre el total: "+e.layer.feature.properties.name);

          var barChartData = {
                  labels : ["Matriculados","Muebles","Superficie","Docentes"],
                  datasets : [
                          {
                                  fillColor : "rgba(220,220,220,0.5)",
                                  strokeColor : "rgba(220,220,220,0.8)",
                                  highlightFill: "rgba(220,220,220,0.75)",
                                  highlightStroke: "rgba(220,220,220,1)",
                                  data : [e.layer.feature.properties.matriculados_por_dpto/1307150*100,
                                      e.layer.feature.properties.monto_muebles_por_dpto/267605*100,
                                      e.layer.feature.properties.superficie_por_dpto/40583*100,
                                      e.layer.feature.properties.monto_docentes_por_dpto/55153*100]
                          }
                  ]
          };

                  var oldcanv = document.getElementById('canvas');
                  var holder=document.getElementById('holder');
                  holder.removeChild(oldcanv);

                  var canv = document.createElement('canvas');
                  canv.id = 'canvas';
                  canv.height="500";
                  canv.width="600";
                  holder.appendChild(canv);


                  var ctx = document.getElementById("canvas").getContext("2d");
                  window.myBar = new Chart(ctx).Bar(barChartData, {
                          responsive : false
                  });

                  myBar.datasets[0].bars[0].fillColor = "green"; //bar 1
                  myBar.datasets[0].bars[0].highlightFill="#312f2f";
                  myBar.datasets[0].bars[1].fillColor = "orange"; //bar 2
                  myBar.datasets[0].bars[1].highlightFill="#312f2f";
                  myBar.datasets[0].bars[2].fillColor = "red"; //bar 3
                  myBar.datasets[0].bars[2].highlightFill="#312f2f";
                  myBar.datasets[0].bars[3].fillColor = "blue";
                  myBar.datasets[0].bars[3].highlightFill="#312f2f";
                  myBar.update();    

        }
      });

      varChoropleth.addTo(map);

      var legend = L.control({position: 'bottomleft'});
      legend.onAdd = function (map) {
          var div = L.DomUtil.create('div', 'info legend'),
              grades = [1, 1500, 3000, 4500, 6000, 7500, 9000, 10500],
              labels = ['1',  '1.500', '3.000', '4.500', '6.000', '7.500', '9.000', '10.500'];
          // loop through our density intervals and generate a label with a colored square for each interval
          for (var i = 0; i < grades.length; i++) {
              div.innerHTML +=
                  '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                  grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
          }
          return div;
      };
      legend.addTo(map);

      function getColor(d) {
          //'#9999e1','#6a6abf','#4646a0','#2b2b88','#181866','#0d0d4d', '#07073f', '#020227'
          return d > 10500 ? '#020227' : 
             d > 9000  ? '#07073f' :
             d > 7500  ? '#0d0d4d' :
             d > 6000  ? '#181866' :
             d > 4500   ? '#2b2b88' :
             d > 3000   ? '#4646a0' :
             d > 1500   ? '#6a6abf' :
                        '#9999e1';
      }
  //colors: ['#ffdccc','#ffb899','#ff9566','#ff7133','#cc3e00','#992f00', '#661f00', '#331000'],

    </script>
    </div>
  </div>
      
  <div class="col-md-5" style=" margin-left: 40px">
      <div class="row">
          
<label id="estado" style=" margin-left: 80px; margin-right: auto; margin-top: 30px;height: 100%; width: 100%;text-align: center; font-size: 25px;">Porcentaje sobre el total: Asunción</label>

      </div>
    <div id="holder">
    <canvas id="canvas" height="500" width="600"></canvas>

      </div>
    <script>
          window.onload = function(){
              var barChartData = {
                  labels : ["Matriculados","Muebles","Superficie","Docentes"],
                  datasets : [
                          {
                                  fillColor : "rgba(220,220,220,0.5)",
                                  strokeColor : "rgba(220,220,220,0.8)",
                                  highlightFill: "rgba(220,220,220,0.75)",
                                  highlightStroke: "rgba(220,220,220,1)",
                                  data : [statesData.features[3].properties.matriculados_por_dpto/1307150*100,
                                      statesData.features[3].properties.monto_muebles_por_dpto/267605*100,
                                      statesData.features[3].properties.superficie_por_dpto/40583*100,
                                      statesData.features[3].properties.monto_docentes_por_dpto/55153*100]
                          }
                  ]
          };

                  var oldcanv = document.getElementById('canvas');
                  var holder=document.getElementById('holder');
                  holder.removeChild(oldcanv);

                  var canv = document.createElement('canvas');
                  canv.id = 'canvas';
                  canv.height="500";
                  canv.width="600";
                  holder.appendChild(canv);


                  var ctx = document.getElementById("canvas").getContext("2d");
                  window.myBar = new Chart(ctx).Bar(barChartData, {
                          responsive : false
                  });

                  myBar.datasets[0].bars[0].fillColor = "green"; //bar 1
                  myBar.datasets[0].bars[0].highlightFill="#312f2f";
                  myBar.datasets[0].bars[1].fillColor = "orange"; //bar 2
                  myBar.datasets[0].bars[1].highlightFill="#312f2f";
                  myBar.datasets[0].bars[2].fillColor = "red"; //bar 3
                  myBar.datasets[0].bars[2].highlightFill="#312f2f";
                  myBar.datasets[0].bars[3].fillColor = "blue";
                  myBar.datasets[0].bars[3].highlightFill="#312f2f";
                  myBar.update(); 





          }

          </script>
  </div>
</div>
</body>
</html>
